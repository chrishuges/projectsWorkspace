---
title: "Polysome curve plotting"
output:
  html_notebook:
      code_folding: none
---

This document details plotting of curves from polysome fractionation. 

## Setting up the environment

These are packages you will need for this notebook. For exact versions used, please refer to the session info at the bottom of this notebook.

```{r, message = FALSE, warning = FALSE}
###########################################################
library('tidyverse')
library('ggplot2')
library('RColorBrewer')
library('zoo')
```

<div style="margin-bottom:50px;"></div>

Set the base folders where we will do the work.

```{r}
##########################################################################################
generalDatasets = 'C:/Users/chughes/Documents/bccrc/projectsRepository/generalDatasets'
baseWorkspace = 'C:/Users/chughes/Documents/bccrc/projectsWorkspace/sorensenLab/relatedToOthers'
baseRepository = 'C:/Users/chughes/Documents/bccrc/projectsRepository/sorensenLab/relatedToOthers'
#generalDatasets = 'C:/Users/chris/OneDrive/Documents/bccrc/projectsRepository/generalDatasets'
#baseWorkspace = 'C:/Users/chris/OneDrive/Documents/bccrc/projectsWorkspace/sorensenLab/relatedToYbx1'
#baseRepository = 'C:/Users/chris/OneDrive/Documents/bccrc/projectsRepository/sorensenLab/relatedToYbx1'
```

<div style="margin-bottom:50px;"></div>

## Data processing

Read the curve file generated by the fractionator.

```{r, message = FALSE, warning = FALSE}
###########################################################
dmsoData = read_csv(paste(baseRepository, '/polysomes20220208_mikeMg633Cr131bDmso8nM/polysomes20220208_mg633CellsCr131bTreatment_dmso_1.csv', sep = ''), skip = 45) %>%
  dplyr::select(`Position(mm)`, Absorbance) %>%
  dplyr::rename(position = `Position(mm)`) %>%
  dplyr::mutate(dataset = 'dmso')
cr1Data = read_csv(paste(baseRepository, '/polysomes20220208_mikeMg633Cr131bDmso8nM/polysomes20220208_mg633CellsCr131bTreatment_8nM_2.csv', sep = ''), skip = 45) %>%
  dplyr::select(`Position(mm)`, Absorbance) %>%
  dplyr::rename(position = `Position(mm)`) %>%
  dplyr::mutate(dataset = 'CR1-31b 8nM') %>%
  dplyr::mutate(position = position + 0.4)

##
polyData = rbind(dmsoData, cr1Data)
```

<div style="margin-bottom:50px;"></div>

Plot the data.

```{r}
###########################################################
polyDataSubset = polyData %>%
  filter(position >= 5 & Absorbance <= 5)

#80S plot
##
ggplot(polyDataSubset, aes(position, Absorbance, color = dataset)) +
  geom_line(size = 0.5) + 
  scale_y_continuous(limits = c(0,4.3), breaks = seq(0,6,0.4)) +
  scale_color_manual(values = c(brewer.pal(3,'OrRd')[3], brewer.pal(3,'Greys')[2])) +
  labs(x = 'Position (mm)', y = 'Absorbance', title = 'CR1-31b treatment monosomes') +
  theme_classic() +
  theme(legend.position = 'none')
ggsave(paste(baseRepository, '/polysomes20220208_mikeMg633Cr131bDmso8nM/lineplot_dmsoCr131b8nm_monosomeRegion.pdf',sep=''),
       useDingbats = FALSE, width = 2, height = 2)



#polysome plot
##
ggplot(polyDataSubset, aes(position, Absorbance, color = dataset)) +
  geom_line(size = 0.5) + 
  scale_y_continuous(limits = c(0,1.6), breaks = seq(0,4,0.4)) +
  scale_color_manual(values = c(brewer.pal(3,'OrRd')[3], brewer.pal(3,'Greys')[2])) +
  labs(x = 'Position (mm)', y = 'Absorbance', title = 'CR1-31b treatment polysomes') +
  theme_classic() +
  theme(legend.position = 'none')
ggsave(paste(baseRepository, '/polysomes20220208_mikeMg633Cr131bDmso8nM/lineplot_dmsoCr131b8nm_polysomeRegion.pdf',sep=''),
       useDingbats = FALSE, width = 2, height = 2)
```

Done.

## Session Info

```{r}
###########################################################
sessionInfo()
```








